<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AVODA Wallet</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.6.2/dist/ethers.umd.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #1f4037, #99f2c8);
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }
    .wallet-container {
      background: #1e293b;
      border-radius: 20px;
      padding: 30px;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      animation: fadeIn 0.5s ease-in-out;
    }
    h1 {
      text-align: center;
      font-size: 1.8rem;
      margin-bottom: 1.5rem;
    }
    input, button, select {
      width: 100%;
      padding: 12px;
      margin-bottom: 1rem;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
    }
    button {
      background-color: #4ade80;
      color: black;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    button:hover {
      background-color: #22c55e;
    }
    .balance, .history {
      margin-top: 1.2rem;
      font-size: 0.95rem;
      background: #334155;
      padding: 1rem;
      border-radius: 10px;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(20px);}
      to {opacity: 1; transform: translateY(0);}
    }
  </style>
</head>
<body>
  <div class="wallet-container">
    <h1>AVODA Wallet</h1>

    <button onclick="connectWallet()">üîó Connect Wallet</button>
    <button onclick="createWallet()">üÜï Create Wallet</button>
    <input type="text" id="privateKey" placeholder="Paste Private Key" />
    <button onclick="importWallet()">üì• Import Wallet</button>

    <div class="balance">
      <strong>Balance:</strong> <span id="walletBalance">0 ETH</span>
    </div>

    <input type="text" id="depositAddress" placeholder="Your Deposit Address (ETH)" />
    <button onclick="copyAddress()">üìã Copy Address</button>

    <input type="text" id="withdrawTo" placeholder="Withdraw To Address" />
    <input type="text" id="withdrawAmount" placeholder="Amount in ETH" />
    <button onclick="withdrawEth()">üí∏ Withdraw</button>

    <select id="networkSelect">
      <option value="mainnet">Ethereum Mainnet</option>
      <option value="goerli">Goerli Testnet</option>
    </select>
    <button onclick="switchNetwork()">üåê Switch Network</button>

    <div class="history">
      <strong>Transaction History:</strong>
      <ul id="txHistory">
        <li>No transactions yet.</li>
      </ul>
    </div>
  </div>

  <script>
    let provider;
    let signer;

    async function connectWallet() {
      if (window.ethereum) {
        provider = new ethers.BrowserProvider(window.ethereum);
        await provider.send("eth_requestAccounts", []);
        signer = await provider.getSigner();
        const address = await signer.getAddress();
        document.getElementById('depositAddress').value = address;
        updateBalance();
      } else {
        alert("Please install MetaMask to use this wallet.");
      }
    }

    async function createWallet() {
      const wallet = ethers.Wallet.createRandom();
      alert(`Wallet Address: ${wallet.address}\nPrivate Key: ${wallet.privateKey}`);
      document.getElementById('privateKey').value = wallet.privateKey;
      document.getElementById('depositAddress').value = wallet.address;
    }

    async function importWallet() {
      const pk = document.getElementById('privateKey').value.trim();
      if (!pk) return alert("Please enter a private key.");
      try {
        signer = new ethers.Wallet(pk);
        document.getElementById('depositAddress').value = signer.address;
        updateBalance();
      } catch (err) {
        alert("Invalid private key");
      }
    }

    async function updateBalance() {
      if (!signer) return;
      const balance = await provider.getBalance(signer.address);
      document.getElementById('walletBalance').textContent = ethers.formatEther(balance) + ' ETH';
    }

    async function copyAddress() {
      const addr = document.getElementById('depositAddress').value;
      await navigator.clipboard.writeText(addr);
      alert("Address copied to clipboard");
    }

    async function withdrawEth() {
      if (!signer || !provider) return alert("Connect wallet first");
      const to = document.getElementById('withdrawTo').value.trim();
      const amount = document.getElementById('withdrawAmount').value.trim();
      if (!to || !amount) return alert("Fill in both fields");
      try {
        const tx = await signer.sendTransaction({
          to,
          value: ethers.parseEther(amount)
        });
        alert("Transaction sent! TX Hash: " + tx.hash);
        document.getElementById('txHistory').innerHTML += `<li>${tx.hash}</li>`;
        updateBalance();
      } catch (e) {
        alert("Transaction failed: " + e.message);
      }
    }

    async function switchNetwork() {
      const selected = document.getElementById('networkSelect').value;
      let chainId = '0x1'; // Mainnet by default
      if (selected === 'goerli') chainId = '0x5';
      try {
        await window.ethereum.request({
          method: 'wallet_switchEthereumChain',
          params: [{ chainId }],
        });
      } catch (e) {
        alert("Failed to switch network: " + e.message);
      }
    }
  </script>
</body>
</html>

